# -*- coding: utf-8 -*-
"""House Price Prediction

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1yby8EENK7TZ_sDVTiDrcLrBakeA_i31p

Loading and Exploring the data
"""

import pandas as pd
train_data = pd.read_csv('/content/train.csv')
print(train_data.head())

"""Preprocessing the Data and Splitting the data into Training and Testing Series"""

import pandas as pd
from sklearn.model_selection import train_test_split

train_data = pd.read_csv('train.csv')

num_samples = len(train_data)
if num_samples > 1:
    X = train_data[['GrLivArea', 'BedroomAbvGr', 'FullBath']]
    y = train_data['SalePrice']
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

else:
    print("Not enough samples in the dataset. Verify that the dataset is loaded correctly.")

"""Building and Training the Linear Regression Model"""

from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

model = LinearRegression()
model.fit(X_train, y_train)
y_pred = model.predict(X_test)

mse = mean_squared_error(y_test, y_pred)
print(f'Mean Squared Error: {mse}')

"""Making predictions on the Test Set"""

test_data = pd.read_csv('/content/test.csv')

X_test_set = test_data[['GrLivArea', 'BedroomAbvGr', 'FullBath']]

predictions = model.predict(X_test_set)
print(predictions)

"""Visualization of the data"""

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

train_data = pd.read_csv('train.csv')

print(train_data.describe())

sns.pairplot(train_data[['GrLivArea', 'BedroomAbvGr', 'FullBath', 'SalePrice']])
plt.show()

correlation_matrix = train_data[['GrLivArea', 'BedroomAbvGr', 'FullBath', 'SalePrice']].corr()
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', fmt=".2f")
plt.title('Correlation Heatmap')
plt.show()

sns.boxplot(x='BedroomAbvGr', y='SalePrice', data=train_data)
plt.title('Boxplot of SalePrice based on the number of bedrooms')
plt.show()

